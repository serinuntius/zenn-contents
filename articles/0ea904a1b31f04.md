---
title: "ã€ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã€‘ç§˜åŒ¿ã—ãŸã„å€¤ã®æ‰€æœ‰ã‚’è¨¼æ˜ã™ã‚‹ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒ³ãƒˆã‚¹ã‚­ãƒ¼ãƒ ã«ã¤ã„ã¦ ~Pedersen Commitmentã‚’æ·»ãˆã¦~"
emoji: "ğŸ•Œ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Ethereum", "Solidity", "PedersenCommitment"]
published: true
publication_name: "noplan_inc"
published_at: 2022-12-03 06:30
---

## ã¯ã˜ã‚ã«

ã“ã‚“ã«ã¡ã¯ã€œã€æœ¬è¨˜äº‹ã¯ [Ethereum Advent Calendar 2022](https://qiita.com/advent-calendar/2022/ethereum) ã®3æ—¥ç›®ã®è¨˜äº‹ã§ã™ã€‚

ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒ¼ãƒ³ã¨ã„ã†ã‹ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚’æ›¸ã„ã¦ã„ã‚‹ã¨ãã«ã€ç§˜å¯†ã®å€¤ã‚’æ‰±ã„ãŸã„ã¨ãã¯ãªã„ã§ã—ã‚‡ã†ã‹ï¼Ÿ

ä¾‹ãˆã°ã€æŠ•ç¥¨ã§ã‚ã£ãŸã‚Šã€ã‚²ãƒ¼ãƒ ã ã£ãŸã‚Šã€ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ã‚’é‡è¦–ã—ãŸä½•ã‹ã§ã‚ã£ãŸã‚Šãƒ»ãƒ»ãƒ»ã€‚
ãã—ã¦ãã®å€¤ã¯å¾Œã‹ã‚‰é–‹ç¤ºã—ã¦è‰¯ã„å ´åˆã¨ã€ãšã£ã¨é–‹ç¤ºã—ãŸããªã„å ´åˆãŒã‚ã‚Šã¾ã™ã€‚

ãã†ã„ã†å ´åˆã®ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ã—ã¦ã€`ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒ³ãƒˆã‚¹ã‚­ãƒ¼ãƒ `ã¨å‘¼ã°ã‚Œã‚‹ã‚‚ã®ãŒã‚ã‚Šã¾ã™ã€‚æœ¬è¨˜äº‹ã§ã¯ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒ³ãƒˆã‚¹ã‚­ãƒ¼ãƒ ã®ï¼‘ã¤ã§ã‚ã‚‹ã€`Pedersen Commitment` ã‚’è©¦ã—ãªãŒã‚‰ã€ç°¡å˜ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œã£ã¦ã¿ãŸã„ã¨æ€ã„ã¾ã™ã€‚
ã¾ãŸè‘—è€…ã¯æš—å·å­¦ã®å°‚é–€å®¶ã§ã¯ãªã„ãŸã‚ã€DYOR & VerifyãŠé¡˜ã„ã—ã¾ã™ã€‚


## ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒ³ãƒˆã‚¹ã‚­ãƒ¼ãƒ ã¨ã¯ï¼Ÿ
>ãƒ“ãƒƒãƒˆã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒ³ãƒˆã€ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒ³ãƒˆæ–¹å¼ã¨ã¯ã€æš—å·ç†è«–ã«ãŠã‘ã‚‹ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§ã‚ã‚‹ã€‚ãƒ“ãƒƒãƒˆã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒ³ãƒˆã‚’ç”¨ã„ã‚‹ã“ã¨ã§ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯å€¤ã‚’ç§˜å¯†è£ã«ã‚³ãƒŸãƒƒãƒˆã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚ã¾ãŸã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯å¾Œã«ã‚³ãƒŸãƒƒãƒˆã•ã‚ŒãŸå€¤ã‚’æ˜ã‚‰ã‹ã«ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã‚ã‚‹ã€‚ ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒ³ãƒˆæ–¹å¼ã‚’æƒ³åƒã™ã‚‹ã«ã¯ä»¥ä¸‹ã®å–©ãˆãŒæœ‰åŠ¹ã§ã‚ã‚‹ã€‚é€ä¿¡è€…ã¯å€¤ã‚’æ›¸ã„ãŸç´™ã‚’ç®±ã«å…¥ã‚Œã‚«ã‚®ã‚’æ›ã‘ã€ãã®ç®±ã‚’å—ä¿¡è€…ã«é€ã‚‹ã€‚ç®±ã®ä¸­èº«ã¯å—ä¿¡è€…ã«ã¯è¦‹ãˆãªã„ã—ã€é€ä¿¡è€…ãŒéµã‚’é€ã‚‰ãªã‘ã‚Œã°éŒ å‰ã‚’é–‹ã‘ã‚‹ã“ã¨ã‚‚ã§ããªã„ã€‚ã¾ãŸå—ä¿¡è€…ãŒç®±ã‚’æŒã£ã¦ã„ã‚‹ã®ã§é€ä¿¡è€…ãŒç®±ã®ä¸­èº«ã‚’æ”¹ã–ã‚“ã™ã‚‹ã“ã¨ã‚‚ä¸å¯èƒ½ã§ã‚ã‚‹ã€‚ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒ³ãƒˆæ–¹å¼ã¯æš—å·ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã¨å¯†æ¥ãªé–¢ä¿‚ã‚’æŒã£ã¦ã„ã‚‹ã€‚ã¨ãã«ã‚¼ãƒ­çŸ¥è­˜è¨¼æ˜ã‚„ãƒãƒ«ãƒãƒ‘ãƒ¼ãƒ†ã‚£è¨ˆç®—ã€ã¾ãŸé›»å­ãƒãƒãƒ¼ã‚„é›»å­æŠ•ç¥¨ ã«ç”¨ã„ã‚‰ã‚Œã¦ã„ã‚‹ã€‚ [ãƒ“ãƒƒãƒˆã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒ³ãƒˆ - Wikipedia](https://ja.wikipedia.org/wiki/%E3%83%93%E3%83%83%E3%83%88%E3%82%B3%E3%83%9F%E3%83%83%E3%83%88%E3%83%A1%E3%83%B3%E3%83%88)

ã‚‰ã—ã„ã§ã™ã€‚ã“ã®è¨˜äº‹ã§ã¯ `ãƒ“ãƒƒãƒˆã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒ³ãƒˆ = ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒ³ãƒˆã‚¹ã‚­ãƒ¼ãƒ ` ã¨ã—ã¦æ‰±ã„ã¾ã™ã€‚

ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒ³ãƒˆã‚¹ã‚­ãƒ¼ãƒ ã§ã¯

- ç§˜åŒ¿æ€§
  - ã‚³ãƒŸãƒƒãƒˆã™ã‚‹å‰ã®å€¤ãŒå—ä¿¡è€…ãŒã‚ã‹ã‚‰ãªã„
- æŸç¸›æ€§
  - ã‚³ãƒŸãƒƒãƒˆã™ã‚‹å‰ã®å€¤ã‚’å¾Œã‹ã‚‰å¤‰æ›´ã§ããªã„

ã¨ã„ã†æ€§è³ªãŒå¤§äº‹ã«ãªã£ã¦ãã¾ã™ã€‚

é€ä¿¡è€…ãŒã‚ã‚‹å€¤ã‚’ç§˜åŒ¿ã•ã‚ŒãŸå€¤ã«å¤‰æ›ã—å—ä¿¡è€…ã«å…¬é–‹ã™ã‚‹ã“ã¨ã‚’**ã‚³ãƒŸãƒƒãƒˆ**ã¨ã„ã†ã€‚
é€†ã«ç§˜åŒ¿ã•ã‚ŒãŸå€¤ã‚’å¾©å…ƒã§ãã‚‹ã‚ˆã†ãªä»˜åŠ çš„ãªæƒ…å ±ã‚’å—ä¿¡è€…ã«å…¬é–‹ã™ã‚‹ã“ã¨ã‚’**ãƒ‡ã‚³ãƒŸãƒƒãƒˆ**ã¨ã„ã†ã€‚

## ãƒãƒƒã‚·ãƒ¥é–¢æ•°ã‚’åˆ©ç”¨ã—ãŸã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒ³ãƒˆ
ãƒãƒƒã‚·ãƒ¥é–¢æ•°ã‚‚ä¹±æ•°(ã‚½ãƒ«ãƒˆ)ã¨çµ„ã¿åˆã‚ã›ã‚‹ã¨ `ç§˜åŒ¿æ€§` ã¨ `æŸç¸›æ€§` ã‚’æ‰‹ã«å…¥ã‚Œã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
ã‚‚ã—ã€ä¹±æ•°ã‚’ä½¿ã‚ãªã„å ´åˆã¯ã€[ãƒ¬ã‚¤ãƒ³ãƒœãƒ¼ãƒ†ãƒ¼ãƒ–ãƒ«](https://ja.wikipedia.org/wiki/%E3%83%AC%E3%82%A4%E3%83%B3%E3%83%9C%E3%83%BC%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB)ã®ã‚ˆã†ãªæ”»æ’ƒãŒã§ãã¦ã—ã¾ã„ã¾ã™ã€‚ã‚½ãƒ«ãƒˆ(ä¹±æ•°)ãŒå¿…è¦ã«ãªã‚‹ã‚ã‘ã§ã™ã­ã€‚

:::message
ã“ã®è¾ºã®ãƒãƒƒã‚·ãƒ¥é–¢æ•°ã®é€†ç®—ã¿ãŸã„ãªã¨ã“ã‚ã«èˆˆå‘³ãŒã‚ã‚‹æ–¹ã¯ `ã‚¹ãƒˆãƒ¬ãƒƒãƒãƒ³ã‚°`, `ã‚½ãƒ«ãƒˆ`, `bcrypt` è¾ºã‚Šã®ãƒ¯ãƒ¼ãƒ‰ã§èª¿ã¹ã¦ã¿ã‚‹ã¨å¹¸ã›ã«ãªã‚Œã‚‹ã¨æ€ã„ã¾ã™ã€‚
:::

ä¾‹ãˆã°ã‚¸ãƒ£ãƒ³ã‚±ãƒ³ã®æ‰‹ã‚’ã‚³ãƒŸãƒƒãƒˆã—ãŸã„ã¨ã™ã‚‹ã¨ã€æ¬¡ã®ã‚ˆã†ãªæ„Ÿã˜ã«ãªã‚‹ã§ã—ã‚‡ã†ã€‚

ããƒ¼ã€ã¡ã‚‡ãã€ã±ãƒ¼ã‚’ãã‚Œãã‚Œ0, 1, 2ã¨ã™ã‚‹ã€‚
[æš—å·è«–çš„æ“¬ä¼¼ä¹±æ•°ç”Ÿæˆå™¨](https://ja.wikipedia.org/wiki/%E6%9A%97%E5%8F%B7%E8%AB%96%E7%9A%84%E6%93%AC%E4%BC%BC%E4%B9%B1%E6%95%B0%E7%94%9F%E6%88%90%E5%99%A8) ã‚’ç”¨ã„ã¦ã€ã‚½ãƒ«ãƒˆã‚’ç”Ÿæˆã—ã¾ã™ã€‚

Unixãªç’°å¢ƒã§ã€bashã§è©¦ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚
```bash
# 256bitãªå€¤ã‚’base64ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã—ã¦saltã¨ã—ã¦åˆ©ç”¨ã€‚
alice $ SALT=$(dd if=/dev/urandom bs=256 count=1 2> /dev/null | base64)

# è©¦ã—ã«å‡ºåŠ›ã—ã¦ã¿ã‚‹
alice $ echo $SALT
bLs98qz0Jg0L2Oonn/hW8fXZmQXY/MHd9hKoFprcozTuJDyPWGCFpLLsYrmpv0f24FhZ6TEk869srbgASl+vFMKC7iv8FyDbvz4o2drbYHfdaPIw81zGQWdEx1GvzBUMoELio2ofS7ZnMs89pSKLm+tO894ztAo3GREY9aelxB0HJbqM8J4/4xN3QSCfrO0WkiZ7jDFCYuv3hixOgdO8npc+FV3dsBEBY5TY+G2r962lkQD/bjZWfM+evQepfitDdaITkBeCsP6fORTgft1DbIZ2Gh58WcDSS0/HD/141gdSg0DRXhZhDxza/B7/1isfTAIWTTY6DPZf92DVI4UgCg==

# sha256ã‚’ä½¿ã£ã¦ï¼(ããƒ¼)ã¨ã‚½ãƒ«ãƒˆã§ãƒãƒƒã‚·ãƒ¥ã«ã‹ã‘ã¦ã¿ã‚‹
# 3974...ãŒã‚³ãƒŸãƒƒãƒˆã•ã‚ŒãŸå€¤
alice $ echo 0.$SALT | shasum -a 256
39749134deefba1ff722519b7635513ccd70c75fc4ba991b53732d5da7642287 

# bobã«ãªã‚Šãã£ã¦ã€ã‚³ãƒŸãƒƒãƒˆã•ã‚ŒãŸå€¤ã‚’aliceã‹ã‚‰å—ã‘å–ã‚‹
bob $ COMMIT=39749134deefba1ff722519b7635513ccd70c75fc4ba991b53732d5da7642287

# å½“ãŸã‚Šå‰ã ã‘ã©ã€COMMITã ã‘ã§ã¯ã€bobã¯ä½•ã®æ‰‹ã‚’å‡ºã•ã‚ŒãŸã‹ã‚ã‹ã‚‰ãªã„ã€‚
# ãƒ‡ã‚³ãƒŸãƒƒãƒˆã—ã¦ã€ã˜ã‚ƒã‚“ã‘ã‚“ã®æ‰‹ã‚’çŸ¥ã‚ŠãŸã„ã®ã§aliceã«æ‰‹ã¨saltã‚’æ•™ãˆã¦ã‚‚ã‚‰ã†
bob $ HAND=0
bob $ SALT=bLs98qz0Jg0L2Oonn/hW8fXZmQXY/MHd9hKoFprcozTuJDyPWGCFpLLsYrmpv0f24FhZ6TEk869srbgASl+vFMKC7iv8FyDbvz4o2drbYHfdaPIw81zGQWdEx1GvzBUMoELio2ofS7ZnMs89pSKLm+tO894ztAo3GREY9aelxB0HJbqM8J4/4xN3QSCfrO0WkiZ7jDFCYuv3hixOgdO8npc+FV3dsBEBY5TY+G2r962lkQD/bjZWfM+evQepfitDdaITkBeCsP6fORTgft1DbIZ2Gh58WcDSS0/HD/141gdSg0DRXhZhDxza/B7/1isfTAIWTTY6DPZf92DVI4UgCg==

# æœ¬å½“ã«ã‚°ãƒ¼ã ã£ãŸã®ã‹ã‚³ãƒŸãƒƒãƒˆã•ã‚ŒãŸå€¤ã«ãªã‚‹ã‹verifyã™ã‚‹
bob $ echo $HAND.$SALT | shasum -a 256
39749134deefba1ff722519b7635513ccd70c75fc4ba991b53732d5da7642287 
# ^^^ aliceãŒäº‹å‰ã«ã‚³ãƒŸãƒƒãƒˆã—ã¦ã„ãŸå€¤ã¨æ­£ã—ã„ã®ã§ã€ç¢ºã‹ã«ããƒ¼(0)ã‚’å‡ºã—ã¦ã„ãŸã¨ã‚ã‹ã‚‹
```

ã“ã‚Œã¯å¯¾è©±å½¢å¼ã§ã‚„ã‚Šã¾ã—ãŸãŒã€ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆ(Solidity)ã‚’ç”¨ã„ã¦ã˜ã‚ƒã‚“ã‘ã‚“ã‚’ã™ã‚‹ã®ã§ã‚ã‚Œã°ã€ä»¥ä¸‹ã®ã‚ˆã†ãªè¨˜äº‹ã‚’å‚è€ƒã«ã™ã‚‹ã¨ã„ã„ã§ã—ã‚‡ã†ã€‚
[Exploring Commit-Reveal Schemes on Ethereum](https://medium.com/swlh/exploring-commit-reveal-schemes-on-ethereum-c4ff5a777db8)

## Pedersen Commitmentã¨ã¯ï¼Ÿ
Pedersen Commitmentã¨ã¯ç…§æ˜è€…ãŒã‚ã‚‹å€¤ã‚’å…¬é–‹ã—ãŸã‚Šå¤‰æ›´ã—ãŸã‚Šã™ã‚‹ã“ã¨ãªãã€ã‚³ãƒŸãƒƒãƒˆã§ãã‚‹æš—å·ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã§ã™ã€‚

åŠ æ³•æº–åŒå‹æš—å·ã®ï¼‘ã¤ã§ã€æš—å·åŒ–ã—ãŸã¾ã¾å€¤ã‚’è¶³ã—ç®—(åŠ æ³•)ã§ãã‚‹ã¨ã„ã†ç‰¹å¾´ãŒã‚ã‚Šã¾ã™ã€‚é›¢æ•£å¯¾æ•°ã‚’ç”¨ã„ã¦éå¯¾ç§°æ€§ã‚’å¾—ã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚

$$
c(x,r) + c(x', r') = (x + x')P + (r + r')Q = c(x + x', r + r')
$$

(a, b, c, d)ã®ä¸­èº«ã‚’çŸ¥ã‚‰ãªãã¦ã‚‚ 

$$
Enc(a) = Enc(b) + Enc(c) + Enc(d)
$$
ã‚’ç¢ºèªã™ã‚Œã°ã€

$$
 a = b + c + d
$$

ãŒæˆã‚Šç«‹ã¤ã€‚

## Rustã§Pedersen Commitmentã‚’è¦‹ã¦ã¿ã‚ˆã†

æœ€è¿‘RustãŒãŠæ°—ã«å…¥ã‚Šãªã®ã§ã€Rustã§æ›¸ã„ã¦ã„ãã¾ã—ã‚‡ã†ï¼

ä¾å­˜é–¢ä¿‚ã¯ã“ã‚“ãªæ„Ÿã˜ã§ã™ã€‚
```toml
# Cargo.toml
[dependencies]
grin_secp256k1zkp = { git = "https://github.com/mimblewimble/rust-secp256k1-zkp.git"}
```

`main.rs` ã¯ã“ã‚“ãªæ„Ÿã˜ã§ã™ã€‚

```rust
use secp256k1zkp::{pedersen::Commitment, rand::thread_rng, ContextFlag, Secp256k1, SecretKey};

fn main() {
    let secp = Secp256k1::with_caps(ContextFlag::Commit);

    fn commit(value: u64, blinding: &SecretKey) -> Commitment {
        let secp = Secp256k1::with_caps(ContextFlag::Commit);
        secp.commit(value, blinding.clone()).unwrap()
    }

    // blindã™ã‚‹ãŸã‚ã®ç§˜å¯†éµã‚’ç”Ÿæˆ
    let blind_alice = SecretKey::new(&secp, &mut thread_rng());
    let blind_bob = SecretKey::new(&secp, &mut thread_rng());

    // 3ã‚’ã‚³ãƒŸãƒƒãƒˆ(æš—å·åŒ–ã•ã‚Œã¦ã‚‹ã®ã§ã€ã“ã‚Œã ã‘æ¸¡ã•ã‚Œã¦ã‚‚ä½•ã‹ã‚ã‹ã‚‰ãªã„)
    let commit_alice = commit(3, &blind_alice);

    // 2ã‚’ã‚³ãƒŸãƒƒãƒˆ(æš—å·åŒ–ã•ã‚Œã¦ã‚‹ã®ã§ã€ã“ã‚Œã ã‘æ¸¡ã•ã‚Œã¦ã‚‚ä½•ã‹ã‚ã‹ã‚‰ãªã„)
    let commit_bob = commit(2, &blind_bob);

    println!("{:?}", commit_alice);
    println!("{:?}", commit_bob);

    // blindã‚’è¶³ã—ã¦ãŠã
    let blind_c = secp
        .blind_sum(vec![blind_alice, blind_bob], vec![])
        .unwrap();

    // blind_cã§5ã‚’ã‚³ãƒŸãƒƒãƒˆ
    let commit_c = commit(5, &blind_c);

    // æš—å·åŒ–ã•ã‚ŒãŸçŠ¶æ…‹ã§ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒ³ãƒˆã‚’åŠ ç®—ã™ã‚‹
    let commit_d = secp
        .commit_sum(vec![commit_alice, commit_bob], vec![])
        .unwrap();

    // ç­‰ã—ã„ï¼(ã™ã”ã„!)
    assert_eq!(commit_c, commit_d);
}
```

## Rustã§ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ã‚’è€ƒæ…®ã—ãŸæ®‹é«˜ãŒã‚ã‹ã‚‰ãªã„ã‚³ã‚¤ãƒ³ã‚’æ›¸ã„ã¦ã¿ã‚ˆã†ï¼

```rust
#[test]
fn private_coin() {
    let secp = Secp256k1::with_caps(ContextFlag::Commit);

    let alice_blind = SecretKey::new(&secp, &mut thread_rng());
    let alice_blind2 = SecretKey::new(&secp, &mut thread_rng());
    let bob_blind = SecretKey::new(&secp, &mut thread_rng());

    // æœ€åˆã®ã‚³ã‚¤ãƒ³ç™ºè¡Œé‡ã®ã‚³ãƒŸãƒƒãƒˆ
    let genesis_commit = secp.commit(5, alice_blind.clone()).unwrap();
    // aliceãŒå—ã‘å–ã‚‹ãŠé‡£ã‚Šã®ã‚³ãƒŸãƒƒãƒˆ
    let otsuri_commit = secp.commit(3, alice_blind2.clone()).unwrap();

    // ã“ã‚Œã‚’bobã«æ¸¡ã™ a2 - a1
    let alice_sum_blind = secp
        .blind_sum(vec![alice_blind2], vec![alice_blind])
        .unwrap();

    // bobãŒå—ã‘å–ã‚‹æ•°é‡ã‚’commit. aliceã«æ¸¡ã™
    let transfer_commit = secp.commit(2, bob_blind.clone()).unwrap();

    // bobãŒblind_sum (a2 - a1 + b1)
    let bob_blind_sum = secp
        .blind_sum(vec![alice_sum_blind, bob_blind], vec![])
        .unwrap();

    // ãŠé‡£ã‚Š + é€ã‚‹é‡ - æœ€åˆã«ç™ºè¡Œã—ãŸã‚³ã‚¤ãƒ³é‡ = 0 ã®ã‚³ãƒŸãƒƒãƒˆã‚’åˆç®—
    let all_commit = secp
        .commit_sum(vec![otsuri_commit, transfer_commit], vec![genesis_commit])
        .unwrap();

    let zero_commit = secp.commit(0, bob_blind_sum).unwrap();

    assert_eq!(zero_commit, all_commit);
}

```



## å®Ÿéš›ã«Solidityã§Pedersen Commitmentã®æ¤œè¨¼ã‚’ã—ã¦ã¿ã‚ˆã†

ã¡ã‚‡ã£ã¨é–“ã«åˆã‚ãªã‹ã£ãŸã®ã§ã€ã“ã“ã¯å®¿é¡Œã¨ã—ã¾ã™ç¬‘ç¬‘

é–“ã«åˆã‚ã›ãŸã‹ã£ãŸã®ã§ã™ãŒã€ã™ã¿ã¾ã›ã‚“ã€‚

Solidityã£ã½ã„ç–‘ä¼¼è¨€èªã§ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚’æ›¸ã„ã¦ã¿ãŸã‚ˆã€‚ã“ã‚“ãªæ„Ÿã˜ã«ãªã‚‹ã‹ã‚‚ã­ï¼

```solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.13;

import "./zkp/PedersenCommitment.sol";

// ã“ã‚Œã¯ç–‘ä¼¼ã‚³ãƒ¼ãƒ‰ã§ã‚ã‚Šã€solidityã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

contract PrivateCoin is PedersenCommitment {
    
    /// @param change_commit ãŠé‡£ã‚Šã®é‡ã®ã‚³ãƒŸãƒƒãƒˆ(é€ä¿¡è€…ã®blindã§ã‚³ãƒŸãƒƒãƒˆ) blind => b1
    /// @param to_amount_commit é€ã‚‹é‡ã®ã‚³ãƒŸãƒƒãƒˆ(å—ä¿¡è€…ã®blindã§ã‚³ãƒŸãƒƒãƒˆ) blind => b2
    /// @param input_commit å—ä¿¡è€…ãŒæœ€åˆã«æŒã£ã¦ã„ãŸé‡ã®ã‚³ãƒŸãƒƒãƒˆ(é€ä¿¡è€…ã®blindã§ã‚³ãƒŸãƒƒãƒˆ) blind => b3
    /// @param receiver_blind_sum å…¨ã¦ã®blindã®sum(b2 - b1 + b3)
    function transfer(change_commit, to_amount_commit, input_commit, receiver_blind_sum) external {
        // ãŠé‡£ã‚Š + é€ã‚‹é‡ - æŒã£ã¦ã‚‹é‡ = 0ã«ãªã‚‹ã‚ˆã†ãªcommitã‚’åŠ ç®—ã™ã‚‹
        let commit = commit_sum([change_commit, to_amount_commit], [input_commit]);

        // å…¨éƒ¨ã®blindã®sumã§0ã«ã‚³ãƒŸãƒƒãƒˆã™ã‚‹
        let zero_commit = commit(0, receiver_blind_sum);

        // ã“ã“ãŒã‚¤ã‚³ãƒ¼ãƒ«ã«ãªã£ã¦ã„ã‚Œã°ã€æˆåŠŸ
        assert(commit, zero_commit);
    }
}
```

## å•é¡Œã§ã™ï¼ï¼ï¼ˆå”çªï¼‰
ã‚‚ã—ã“ã®ç–‘ä¼¼ã‚³ãƒ¼ãƒ‰ãŒæ­£ã—ãå‹•ã„ã¦ã„ãŸã¨ã—ã¦ã‚‚ã€ã“ã®ã‚³ãƒ¼ãƒ‰ã«ã¯è„†å¼±æ€§ãŒã‚ã‚Šã¾ã™ã€‚ãã‚Œã¯ãªã‚“ã§ã—ã‚‡ã†ã‹ï¼Ÿ
ãã®è„†å¼±æ€§ã‚’ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã«ã›ãšã«[Twitterã®DM](https://twitter.com/_serinuntius)ã¾ã§æ•™ãˆã¦ãã ã•ã„ï¼

## ã¾ã¨ã‚
Pedersen Commitmentã‚’åˆã‚ã¦ä½¿ã£ã¦ã¿ã¾ã—ãŸãŒã€è‘—è€…ã®é ­ãŒç¡¬ã™ãã¦æ®‹é«˜ã®ç§˜åŒ¿ã‚’ã—ãªãŒã‚‰blinding factorã‚’ã‚„ã‚Šå–ã‚Šã™ã‚‹ã®ã«è‹¦åŠ´ã—ã¾ã—ãŸã€‚

Pedersen Commitmentä»¥å¤–ã«ã‚‚ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒ³ãƒˆã‚¹ã‚­ãƒ¼ãƒ ã¯å¤šæ•°ã‚ã‚Šã€è‡ªåˆ†ãŒçŸ¥ã£ã¦ã„ã‚‹ã ã‘ã§ã‚‚

- KZGã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒ³ãƒˆ
- Merkle Tree(ãƒãƒƒã‚·ãƒ¥é–¢æ•°ä½¿ã£ã¦ã‚‹ã‹ã‚‰å½“ãŸã‚Šå‰ã¨è¨€ãˆã°å½“ãŸã‚Šå‰ã ã‘ã©)

ç­‰ãŒã‚ã‚Šã¾ã™ã€‚

æœ¬å½“ã¯Merkle Treeã¨ZKPä½¿ã£ã¦ä¸å¿…è¦ã«æƒ…å ±ã‚’é–‹ç¤ºã›ãšã«ã€æ‰€æœ‰ã‚’è¨¼æ˜ã™ã‚‹ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚‚ã‚„ã‚ŠãŸã‹ã£ãŸã®ã§ã™ãŒã€æ™‚é–“ã®éƒ½åˆä¸Šãã“ã¾ã§ã„ã‘ã¾ã›ã‚“ã§ã—ãŸã€‚

Ethereumã‚¢ãƒ‰ãƒ™ãƒ³ãƒˆã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã¨ã„ã†å‰²ã«ãŸã ã®æš—å·å­¦ã®è©±ã«ãªã£ã¦ã—ã¾ã„ã¾ã—ãŸãŒã€å¼•ãç¶šãæ¿ƒã„å†…å®¹ã®è¨˜äº‹ã‚’è¦‹ãŸã„æ–¹ã¯**ã„ã„ã­**ã¨[Twitter](https://twitter.com/_serinuntius)ã®ãƒ•ã‚©ãƒ­ãƒ¼ã‚’ãŠé¡˜ã„ã—ã¾ã™ï¼


## è¬è¾
ã“ã®è¨˜äº‹ã‚’æ›¸ãã«ã‚ãŸã£ã¦ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ã„ãŸã‚‰ã€ã‚ˆãã‚ã‹ã‚‰ãªã„äº‹è±¡ã«ã¶ã¡å½“ãŸã‚ŠTwitterã«æŠ•ç¨¿ã—ã¦ã„ãŸã‚‰ã€å®‰åœŸç¥ã«åŠ©ã‘ã¦ã„ãŸã ãã¾ã—ãŸã€‚ã“ã®å ´ã§æ„Ÿè¬ã‚’é€ã‚ŠãŸã„ã¨æ€ã„ã¾ã™ã€‚
https://twitter.com/techmedia_think/status/1598224092666023937?s=20&t=zdk_3HVqnuEm8K7DjO998w

## å‚è€ƒæ–‡çŒ®
- [ãƒ“ãƒƒãƒˆã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒ³ãƒˆ - Wikipedia](https://ja.wikipedia.org/wiki/%E3%83%93%E3%83%83%E3%83%88%E3%82%B3%E3%83%9F%E3%83%83%E3%83%88%E3%83%A1%E3%83%B3%E3%83%88)
- [ãƒ¬ã‚¤ãƒ³ãƒœãƒ¼ãƒ†ãƒ¼ãƒ–ãƒ« - Wikipedia](https://ja.wikipedia.org/wiki/%E3%83%AC%E3%82%A4%E3%83%B3%E3%83%9C%E3%83%BC%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB)
- [Pedersen Commitment - Moneropedia](https://www.getmonero.org/resources/moneropedia/pedersen-commitment.html)
- [ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒ¼ãƒ³ç³»ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ç€ç›®ã•ã‚Œã‚‹æš—å·æŠ€è¡“](https://www.slideshare.net/herumi/ss-118987665)
- [Bitcoinã®åŒ¿åæ€§ã‚’å‘ä¸Šã•ã›ã‚‹Confidential Transactions](https://techmedia-think.hatenablog.com/entry/2015/12/31/002253)
- [Mimblewimbleã¨Grinã®ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãƒ•ãƒ­ãƒ¼](https://techmedia-think.hatenablog.com/entry/2019/02/15/210135)
