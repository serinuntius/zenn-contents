---
title: "NYCç”£ç‰¹é¸SvelteKitã¨æ—¬ã®EVMã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ ã‚’æ·»ãˆã¦ ~ã‚¦ã‚¨ãƒªãƒ³ãƒˆãƒ³é¢¨~"
emoji: "ğŸ”¥"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Svelte", "ethersjs", "Ethereum", "EVM"]
published: true
publication_name: noplan_inc
---

## ã¯ã˜ã‚ã«

ã“ã‚“ã«ã¡ã¯ã€œã€æœ¬è¨˜äº‹ã¯ [no plan inc. Advent Calendar 2022](https://qiita.com/advent-calendar/2022/noplan_inc) ã®23æ—¥ç›®ã®è¨˜äº‹ã§ã™ã€‚

SvelteKitã¨ethers.jsã‚’ä½¿ã£ã¦ã€Metamaskã‚’èµ·å‹•ã•ã›ã‚‹ã¨ã“ã‚ã¾ã§ã‚„ã£ã¦ã¿ãŸã„ã¨æ€ã„ã¾ã™ã€‚


## æº–å‚™
sveltekitã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ã¾ãšã¯ç”Ÿæˆã—ã¾ã—ã‚‡ã†ã€‚

```bash
npm create svelte@latest web3-sveltekit
Need to install the following packages:
  create-svelte@latest
Ok to proceed? (y) y

create-svelte version 2.0.1

Welcome to SvelteKit!

âœ” Which Svelte app template? â€º Skeleton project
âœ” Add type checking with TypeScript? â€º Yes, using TypeScript syntax
âœ” Add ESLint for code linting? â€¦ No / Yes
âœ” Add Prettier for code formatting? â€¦ No / Yes
âœ” Add Playwright for browser testing? â€¦ No / Yes
âœ” Add Vitest for unit testing? â€¦ No / Yes

Your project is ready!
âœ” Typescript
  Inside Svelte components, use <script lang="ts">
âœ” ESLint
  https://github.com/sveltejs/eslint-plugin-svelte3
âœ” Prettier
  https://prettier.io/docs/en/options.html
  https://github.com/sveltejs/prettier-plugin-svelte#options

Install community-maintained integrations:
  https://github.com/svelte-add/svelte-adders

Next steps:
  1: cd web3-sveltekit
  2: npm install (or pnpm install, etc)
  3: git init && git add -A && git commit -m "Initial commit" (optional)
  4: npm run dev -- --open

To close the dev server, hit Ctrl-C

Stuck? Visit us at https://svelte.dev/chat
```

```bash
yarn dev
```

ã“ã‚Œã§è¡¨ç¤ºã•ã‚Œã‚‹urlã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦è¡¨ç¤ºã•ã‚Œã‚‹ã‹è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚
OKã§ã™ã­ï¼Ÿ

ãã‚Œã§ã¯æ¬¡ã« `svelte-ethers-store` ã‚’installã—ã¾ã—ã‚‡ã†ã€‚
ã“ã‚Œã¯Reactã§è¨€ã†ã¨ã“ã‚ã® `wagmi` ã¨ã‹ `web3-react` çš„ãªã‚„ã¤ã§ã™ã€‚

`web3.js` ã‚’ã„ã¾ã ã«ä½¿ã£ã¦ã„ã‚‹äººã¯ã„ãªã„ã¨æ€ã„ã¾ã™ãŒã€`web3.js` ã®å ´åˆã¯ `svelte-web3` ã¨ã„ã†å§‰å¦¹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒã‚ã‚‹ã¿ãŸã„ã§ã™ã€‚

```bash
yarn add svelte-ethers-store
```

## Svelte Kitã®ä½œæ³•
`routes` ä»¥ä¸‹ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆã¯ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªåãŒãƒ‘ã‚¹ã«ãªã£ã¦ã€ `+page.svelte` ã‚’ä½œã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã€ãã‚ŒãŒãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã•ã‚Œã‚‹ã‚ˆã†ã§ã™ã€‚

`/connect` ã¨ã„ã†ãƒšãƒ¼ã‚¸ã‚’ä½œã‚ŠãŸã„å ´åˆã¯ `routes/connect/+page.svelte` ã‚’ä½œæˆã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
ä½œæ³•ã®è©³ç´°ã¯ [ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚° - svelte kit docs](https://kit.svelte.jp/docs/routing) ã‚’ã”è¦§ãã ã•ã„ã€‚

## Svelte Storeã®ä½œæ³•
å¤§ä½“ã® `svelte-ethers-store` ã®exportã•ã‚Œã¦ã„ã‚‹ãƒ¡ãƒ³ãƒãƒ¼ï¼Ÿã¯Readableã¨ã„ã†ã‚‚ã®ã«ãªã£ã¦ã„ã¾ã™ã€‚

è©³ã—ãã¯[ã“ã¡ã‚‰](https://svelte.jp/tutorial/auto-subscriptions)ã‚’ã¿ã¦ã»ã—ã„ã®ã§ã™ãŒã€ç°¡å˜ã«æ›¸ã„ã¦ãŠãã¾ã™ã€‚

```svelte
// App.svelte
<script>
	import { count } from './stores.js';
	let countValue;

	count.subscribe(value => {
		countValue = value;
	});
</script>

<h1>The count is {countValue}</h1>
```

```js
import { writable } from 'svelte/store';

export const count = writable(0);
```

ã“ã‚“ãªæ„Ÿã˜ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã£ãŸã¨ãã«ã€`App.svelte`ã§storeã®å¤‰æ•°ã‚’importã—ã¦ã„ã¾ã™ã€‚ã“ã‚Œã¯æ­£ç¢ºã«ã¯writableãªã‚“ã§ã™ãŒã€ã“ã®å€¤ã‚’å¤‰æ›´ã•ã‚Œã‚‹åº¦ã«ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã•ã‚Œã‚‹ã‚ˆã†ã«ã—ã‚ˆã†ã¨æ€ã†ã¨ã€subscribeã§eventã‚’ç™ºç”Ÿã™ã‚‹ã®ã‚’å¾…ã£ã¦ã€å¤‰æ•°ã«å…¥ã‚Œã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

ã“ã‚Œã¯éå¸¸ã«é¢å€’ã§ã™ã€‚

ãã‚Œã‚’ç°¡å˜ã«ã™ã‚‹ãŸã‚ã«ã‚·ãƒ³ã‚¿ãƒƒã‚¯ã‚¹ã‚·ãƒ¥ã‚¬ãƒ¼ã¨ã—ã¦ã€ `$` ãŒç”¨æ„ã•ã‚Œã¦ã„ã¾ã™ã€‚
App.svelteã¯æ¬¡ã®ã‚ˆã†ã«æ›¸ãç›´ã›ã¾ã™ã€‚


```svelte
// App.svelte
<script>
	import { count } from './stores.js';
</script>

<h1>The count is {$countValue}</h1>
```

ã“ã‚ŒãŒ `svelte-ethers-store` ã§ã‚‚å‡ºã¦ãã‚‹ã®ã§ã€è¦šãˆã¦ãŠãã¾ã—ã‚‡ã†ã€‚


## svelte-ethers-storeä½¿ã£ã¦Metamaskã‚’ç¹‹ã’ã¦ã¿ã‚‹

çµè«–ã‹ã‚‰è¨€ã†ã¨ã“ã‚“ãªæ„Ÿã˜ã§ç¹‹ã’ã‚‰ã‚Œã¾ã™ã€‚

```svelte
<script lang="ts">
import { connected, signer, signerAddress, defaultEvmStores } from 'svelte-ethers-store'

const connect = async () => {
    // ã“ã“ã§ãƒ¡ã‚¿ãƒã‚¹ã‚¯ã¨ç¹‹ãŒã‚‹
    await defaultEvmStores.setProvider();

    // ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã®éƒ¨åˆ†ã˜ã‚ƒãªãã¦ã‚‚ `$` ã‚·ãƒ³ã‚¿ãƒƒã‚¯ã‚¹ã‚’ä½¿ã£ã¦ã€subscribeã‚’çœç•¥å¯èƒ½
    const b = await $signer.getBalance();
    console.log(b);
}

</script>

<h1>Connect</h1>

<ul>
    <li>connected?: {$connected}</li>
    <li>signerAddress: {$signerAddress}</li>
</ul>



<button on:click={connect}>connect</button>
```

`$` ã‚·ãƒ³ã‚¿ãƒƒã‚¯ã‚¹ã‚·ãƒ¥ã‚¬ãƒ¼ã‚’ä½¿ã‚ãªã„ã¨ã“ã‚“ãªæ„Ÿã˜ã§ã™ã€‚

```svelte
<script lang="ts">
import { connected, signer, signerAddress, defaultEvmStores } from 'svelte-ethers-store'

const connect = async () => {
    await defaultEvmStores.setProvider();

    // ã‹ãªã‚Šå†—é•·ã€‚ã€‚ã€‚
    signer.subscribe(async (s) => {
        const b = await signer.getBalance();
        console.log(b);
    });
}

</script>

<h1>Connect</h1>

<ul>
    <li>connected?: {$connected}</li>
    <li>signerAddress: {$signerAddress}</li>
</ul>



<button on:click={connect}>connect</button>
```

ç©æ¥µçš„ã«$ã‚’ä½¿ã£ã¦ã„ããŸã„ã§ã™ã­ğŸ¤‘ğŸ¤‘ğŸ¤‘

## ã¾ã¨ã‚
ethersã¨svelteã‚’ä½¿ã£ãŸã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ä¸‹åœ°ãŒã§ãã¾ã—ãŸã€‚
ã“ã®ã‚ã¨ã¯ã„ã¤ã‚‚é€šã‚Šã®å®Ÿè£…ã«ãªã£ã¦ã„ãã®ã§ã¯ãªã„ã‹ã¨æ€ã„ã¾ã™ã€‚

## no planæ ªå¼ä¼šç¤¾ã«ã¤ã„ã¦
- no planæ ªå¼ä¼šç¤¾ã¯ã€ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒ¼ãƒ³æŠ€è¡“ã€Webã‚µã‚¤ãƒˆé–‹ç™ºã€ãƒã‚¤ãƒ†ã‚£ãƒ–ã‚¢ãƒ—ãƒªé–‹ç™ºã€ãƒãƒ¼ãƒ è‚²æˆã€ãªã©Webã‚µãƒ¼ãƒ“ã‚¹å…¨èˆ¬ã®é–‹ç™ºã‹ã‚‰é‹ç”¨ã‚„æ•™è‚²ã€æ”¯æ´ãªã©ã‚’è¡Œã£ã¦ã„ã¾ã™ã€‚ã‚ˆãã‚ã‹ã‚‰ãªã„ã€ãµã‚ãµã‚ã—ãŸãƒãƒ¼ãƒ—ãƒ©ãƒ³çŠ¶æ…‹ã§ã‚‚å¤§ä¸ˆå¤«ï¼ã”ä¸€ç·’ã«ãƒ—ãƒ©ãƒ³ã‚’ç«‹ã¦ã¦ã„ãã¾ã—ã‚‡ã†ï¼
- [no planæ ªå¼ä¼šç¤¾ã«ã¤ã„ã¦](https://noplan-inc.com)
- [no planæ ªå¼ä¼šç¤¾ | ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒ¼ãƒ³å®Ÿç¸¾](https://noplan-inc.com/blockchain)
- [no planæ ªå¼ä¼šç¤¾ | ãƒ–ãƒ­ã‚°ä¸€è¦§](https://noplan-inc.com/blog)